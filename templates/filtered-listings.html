{% extends 'base.html' %}

{% block title %} AM SA AUTO|HOME {% endblock %}

{% block content %}
<button type="button" id="filterButton" onclick="toggleFilter()">Filter by location</button>
<div id="filterDiv" style="display: none;">
  <form method="POST" id="locationFilterForm" action="{{ url_for('filtered_listings') }}">
    {{ form.hidden_tag() }}

    <input type="text" name="location" id="locationInput" placeholder="Enter Location"/>
    <button type="submit">Apply filter</button>
  </form>

  <form method="POST" id="priceFilterForm" action="{{ url_for('filtered_listings') }}">
    {{ form.hidden_tag() }}

    <input type="number" name="minPrice" id="minPriceInput" placeholder="Min Price"/>
    <input type="number" name="maxPrice" id="maxPriceInput" placeholder="Max Price"/>
    <button type="submit">Apply filter</button>
  </form>

</div>

{% if listings %}
{% for listing in listings %}
  {% with images = listing.images %}
    {% with image = images[0] %}
      <div>
        <a href="{{ url_for('item_details', id=listing.id) }}"><img src="{{ url_for('static', filename=('itemImages/' ~ image.filename)) }}">
        <p>{{ listing.brand }} {{ listing.model }}</p>
        <p>{{ listing.formated_price }}</p>
        <p>Last updated: {{ listing.updated_at_str }}</p>
      </div></a>
    {% endwith %}
  {% endwith %}
{% endfor %}
{% else %}
<p>No results found</p>
{% endif %}

{% endblock %}
